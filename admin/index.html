<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>기사 관리 - 내성 신문</title>
  <meta property="og:title" content="기사 관리 - 내성 신문" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Netlify Identity (로그인 유지) -->
  <script src="https://unpkg.com/netlify-identity-widget@1.9.1/build/netlify-identity-widget.js"></script>

  <!-- CMS가 자동 초기화되지 않도록 먼저 선언 -->
  <script>window.CMS_MANUAL_INIT = true;</script>

  <!-- Decap CMS 본체 -->
  <script src="https://unpkg.com/decap-cms@latest/dist/decap-cms.js"></script>

  <!-- 우리의 커스텀 위젯 등록 스크립트 -->
  <script src="/admin/index.js"></script>
</head>
<body>
  <script>
    // Netlify Identity 로그인 후 /admin/으로
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", (user) => {
        if (!user) {
          window.netlifyIdentity.on("login", () => {
            document.location.href = "/admin/";
          });
        }
      });
    }

    // 커스텀 위젯 등록이 끝난 뒤 수동 초기화
    window.CMS?.init();
  </script>
</body>
</html>
